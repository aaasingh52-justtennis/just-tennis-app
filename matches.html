<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Just Tennis Season 4 - Match Results</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            color: #333;
            background-color: #f5f7fa;
        }
        h1 {
            color: #2c5282;
            border-bottom: 3px solid #2c5282;
            padding-bottom: 10px;
            margin-bottom: 5px;
        }
        .subtitle {
            color: #666;
            margin-bottom: 20px;
        }
        
        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .nav-tab {
            padding: 10px 20px;
            background-color: #e2e8f0;
            color: #4a5568;
            text-decoration: none;
            border-radius: 8px 8px 0 0;
            font-weight: bold;
            transition: background-color 0.2s;
        }
        .nav-tab:hover {
            background-color: #cbd5e0;
        }
        .nav-tab.active {
            background-color: #2c5282;
            color: white;
        }
        
        .table-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        th {
            background-color: #2c5282;
            color: white;
            padding: 12px 10px;
            text-align: left;
            position: sticky;
            top: 0;
        }
        td {
            border-bottom: 1px solid #e2e8f0;
            padding: 10px;
        }
        tr:hover {
            background-color: #f7fafc;
        }
        .winner {
            font-weight: bold;
            color: #276749;
        }
        .loser {
            color: #718096;
        }
        .score {
            font-weight: bold;
            font-size: 16px;
            text-align: center;
        }
        .date-cell {
            white-space: nowrap;
        }
        .loading {
            text-align: center;
            padding: 40px;
            color: #718096;
        }
        .error {
            text-align: center;
            padding: 40px;
            color: #c53030;
            display: none;
        }
        .match-count {
            padding: 10px 15px;
            background-color: #ebf8ff;
            border-radius: 4px;
            font-size: 14px;
            color: #2c5282;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>

<h1>ðŸŽ¾ Just Tennis Season 4 - Match Results</h1>
<p class="subtitle">January 1 - April 1, 2026</p>

<nav class="nav-tabs">
    <a href="index.html" class="nav-tab">Contact List</a>
    <a href="ladder.html" class="nav-tab">Ladder</a>
    <a href="matches.html" class="nav-tab active">Matches</a>
    <a href="rules.html" class="nav-tab">Rules</a>
</nav>

<div class="match-count"><span id="matchCount">0</span> matches played</div>

<div id="loadingMessage" class="loading">Loading match results...</div>
<div id="errorMessage" class="error">Error loading matches.</div>

<div class="table-container">
    <table id="matchesTable" style="display: none;">
        <thead>
            <tr>
                <th>Date</th>
                <th>Winner</th>
                <th>Score</th>
                <th>Loser</th>
            </tr>
        </thead>
        <tbody id="matchesTableBody">
        </tbody>
    </table>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
    const SUPABASE_URL = 'https://bykttkozszstkkxtdeza.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ5a3R0a296c3pzdGtreHRkZXphIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc2OTc0ODgsImV4cCI6MjA4MzI3MzQ4OH0.-PTH-tQTmhg53QBzbaYeYaj__3JXpITrCxJR3AGXY3c';
    
    const db = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    
    // Load matches from Supabase
    async function loadMatches() {
        try {
            // Get all matches with player names
            const { data: matches, error: matchError } = await db
                .from('matches')
                .select('*')
                .order('date', { ascending: false });
            
            if (matchError) throw matchError;
            
            // Get all players for name lookup
            const { data: players, error: playerError } = await db
                .from('players')
                .select('id, name');
            
            if (playerError) throw playerError;
            
            // Create player lookup map
            const playerMap = {};
            players.forEach(p => playerMap[p.id] = p.name);
            
            // Render matches
            const tbody = document.getElementById('matchesTableBody');
            tbody.innerHTML = matches.map(match => {
                const playerAName = playerMap[match.player_a_id] || 'Unknown';
                const playerBName = playerMap[match.player_b_id] || 'Unknown';
                const isPlayerAWinner = match.winner_id === match.player_a_id;
                
                const winnerName = isPlayerAWinner ? playerAName : playerBName;
                const loserName = isPlayerAWinner ? playerBName : playerAName;
                const winnerSets = isPlayerAWinner ? match.player_a_sets : match.player_b_sets;
                const loserSets = isPlayerAWinner ? match.player_b_sets : match.player_a_sets;
                
                const dateObj = new Date(match.date);
                const formattedDate = dateObj.toLocaleDateString('en-GB', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric'
                });
                
                return `
                    <tr>
                        <td class="date-cell">${formattedDate}</td>
                        <td class="winner">${winnerName}</td>
                        <td class="score">${winnerSets} - ${loserSets}</td>
                        <td class="loser">${loserName}</td>
                    </tr>
                `;
            }).join('');
            
            document.getElementById('loadingMessage').style.display = 'none';
            document.getElementById('matchesTable').style.display = 'table';
            document.getElementById('matchCount').textContent = matches.length;
            
        } catch (error) {
            console.error('Error loading matches:', error);
            document.getElementById('loadingMessage').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'block';
        }
    }
    
    // Load on page ready
    document.addEventListener('DOMContentLoaded', loadMatches);
</script>

</body>
</html>
